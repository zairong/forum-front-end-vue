"use strict";(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[356],{4556:function(t,a,e){e.d(a,{Z:function(){return c}});var r=function(){var t=this;t._self._c;return t._m(0)},s=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"spinner"},[a("div",{staticClass:"bouncing-loader"},[a("div"),a("div"),a("div")])])}],i=e(1001),n={},o=(0,i.Z)(n,r,s,!1,null,"52e6d627",null),c=o.exports},1356:function(t,a,e){e.r(a),e.d(a,{default:function(){return N}});var r=function(){var t=this,a=t._self._c;return a("div",{staticClass:"container py-5"},[t.isLoading?a("Spinner"):[a("NavTabs"),a("RestaurantsNavPills",{attrs:{categories:t.categories}}),a("div",{staticClass:"row"},t._l(t.restaurants,(function(t){return a("RestaurantCard",{key:t.id,attrs:{"initial-restaurant":t}})})),1),t.totalPage.length>1?a("RestaurantPagination",{attrs:{categoryId:t.categoryId,currentPage:t.currentPage,totalPage:t.totalPage,previousPage:t.previousPage,nextPage:t.nextPage}}):t._e(),t.restaurants.length<1?a("div",[t._v("此類別目前沒餐廳資料")]):t._e()]],2)},s=[],i=e(4556),n=function(){var t=this,a=t._self._c;return a("div",{staticClass:"col-md-6 col-lg-4"},[a("div",{staticClass:"card mb-4"},[a("img",{staticClass:"card-img-top",attrs:{src:t.restaurant.image,alt:"Card image cap",width:"286px",height:"180px"}}),a("div",{staticClass:"card-body"},[a("p",{staticClass:"card-text title-wrap"},[a("router-link",{attrs:{to:{name:"restaurant",params:{id:t.restaurant.id}}}},[t._v(" "+t._s(t.restaurant.name)+" ")])],1),a("span",{staticClass:"badge badge-secondary"},[t._v(t._s(t.restaurant.Category.name))]),a("p",{staticClass:"card-text text-truncate"},[t._v(" "+t._s(t.restaurant.description)+" ")])]),a("div",{staticClass:"card-footer"},[t.restaurant.isFavorited?a("button",{staticClass:"btn btn-danger btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(a){return t.deleteFavorite(t.restaurant.id)}}},[t._v(" 移除最愛 ")]):a("button",{staticClass:"btn btn-primary btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(a){return t.addFavorite(t.restaurant.id)}}},[t._v(" 加到最愛 ")]),t.restaurant.isLiked?a("button",{staticClass:"btn btn-danger like mr-2",attrs:{disabled:t.isProcessing,type:"button"},on:{click:function(a){return t.deleteIsLiked(t.restaurant.id)}}},[t._v(" Unlike ")]):a("button",{staticClass:"btn btn-primary like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(a){return t.addIsLiked(t.restaurant.id)}}},[t._v(" Like ")])])])])},o=[],c=e(3459),u=e(8390),l=e(6163),d={props:["initialRestaurant"],data(){return{restaurant:this.initialRestaurant,isProcessing:!1}},methods:{async addFavorite(t){try{this.isProcessing=!0;const a=await(0,u.yu)({restaurantId:t}),{data:e}=a;if("error"===e.status)throw new Error(e.message);this.isProcessing=!1,this.restaurant.isFavorited=!0}catch(a){this.isProcessing=!1,l.F.fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"}),console.log("error",a)}},async deleteFavorite(t){try{this.isProcessing=!0;const a=await(0,u.kX)({restaurantId:t}),{data:e}=a;if("error"===e.status)throw new Error(e.message);this.restaurant.isFavorited=!1,this.isProcessing=!1}catch(a){this.isProcessing=!1,l.F.fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"}),console.log("error",a)}},async addIsLiked(t){try{this.isProcessing=!0;const a=await(0,u.kr)({restaurantId:t}),{data:e}=a;if("error"===e.status)throw new Error(e.message);this.restaurant.isLiked=!0,this.isProcessing=!1}catch(a){this.isProcessing=!1,l.F.fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"}),console.log("error",a)}},async deleteIsLiked(t){try{this.isProcessing=!0;const a=await(0,u.VG)({restaurantId:t}),{data:e}=a;if("error"===e.status)throw new Error(e.message);this.restaurant.isLiked=!1,this.isProcessing=!1}catch(a){this.isProcessing=!1,l.F.fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"}),console.log("error",a)}}},mixins:[c.L]},g=d,v=e(1001),h=(0,v.Z)(g,n,o,!1,null,"40b0f3fd",null),p=h.exports,P=function(){var t=this,a=t._self._c;return a("ul",{staticClass:"nav nav-pills mb-4"},[a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"restaurants"}}},[t._v(" 全部 ")])],1),t._l(t.categories,(function(e){return a("li",{key:e.id,staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"restaurants",query:{categoryId:e.id}}}},[t._v(" "+t._s(e.name)+" ")])],1)}))],2)},y=[],f={props:["categories"]},m=f,_=(0,v.Z)(m,P,y,!1,null,"122607fe",null),b=_.exports,k=function(){var t=this,a=t._self._c;return a("nav",{attrs:{"aria-label":"Page navigation example"}},[a("ul",{staticClass:"pagination"},[a("li",{directives:[{name:"show",rawName:"v-show",value:t.previousPage,expression:"previousPage"}],class:["page-item",{disabled:1===t.currentPage}]},[a("router-link",{staticClass:"page-link",attrs:{"aria-label":"Previous",to:{name:"restaurants",query:{categoryId:t.categoryId,page:t.previousPage}}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])],1),t._l(t.totalPage,(function(e){return a("li",{key:e,class:["page-item",{active:t.currentPage===e}]},[a("router-link",{staticClass:"page-link",attrs:{to:{name:"restaurants",query:{categoryId:t.categoryId,page:e}}}},[t._v(" "+t._s(e)+" ")])],1)})),a("li",{directives:[{name:"show",rawName:"v-show",value:t.nextPage,expression:"nextPage"}],class:["page-item",{disabled:t.currentPage===t.totalPage.length}]},[a("router-link",{staticClass:"page-link",attrs:{to:{name:"restaurants",query:{categoryId:t.categoryId,page:t.nextPage}},"aria-label":"Next"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])],1)],2)])},C=[],I={name:"RestaurantPagination",props:["categoryId","currentPage","totalPage","previousPage","nextPage"]},w=I,x=(0,v.Z)(w,k,C,!1,null,"7a8af126",null),L=x.exports,R=e(4818),F={name:"Restaurants",components:{RestaurantCard:p,RestaurantsNavPills:b,RestaurantPagination:L,Spinner:i.Z},data(){return{restaurants:[],categories:[],categoryId:-1,currentPage:1,totalPage:[],previousPage:-1,nextPage:-1,isLoading:!1}},created(){const{page:t="",categoryId:a=""}=this.$route.query;this.fetchRestaurants({queryPage:t,queryCategoryId:a})},beforeRouteUpdate(t,a,e){const{page:r="",categoryId:s=""}=t.query;this.fetchRestaurants({queryPage:r,queryCategoryId:s}),e()},methods:{async fetchRestaurants({queryPage:t,queryCategoryId:a}){try{this.isLoading=!0;const e=await(0,R.nj)({page:t,categoryId:a}),{restaurants:r,categories:s,categoryId:i,page:n,totalPage:o,prev:c,next:u}=e.data;this.restaurants=r,this.categories=s,this.categoryId=i,this.currentPage=n,this.totalPage=o,this.previousPage=c,this.nextPage=u,this.isLoading=!1}catch(e){this.isLoading=!1,console.log("error",e),l.F.fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"})}}}},q=F,Z=(0,v.Z)(q,r,s,!1,null,null,null),N=Z.exports},4818:function(t,a,e){e.d(a,{A4:function(){return i},C2:function(){return n},nj:function(){return s},wF:function(){return o}});var r=e(6163);const s=({page:t="",categoryId:a=""})=>{const e=new URLSearchParams({page:t,categoryId:a}).toString();return(0,r.l)({url:`/restaurants?${e}`,method:"get"})},i=()=>(0,r.l)({url:"/restaurants/feeds",method:"get"}),n=()=>(0,r.l)({url:"/restaurants/top",method:"get"}),o=({restaurantId:t})=>r.l.get(`/restaurants/${t}`)}}]);
//# sourceMappingURL=356.e4935534.js.map