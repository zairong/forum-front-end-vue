"use strict";(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[449],{9669:function(t,e,a){a.d(e,{Z:function(){return c}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mb-3"},[e("h1",[t._v("餐廳後台")]),e("router-link",{attrs:{to:"/admin/restaurants"}},[t._v(" Restaurants ")]),t._v("| "),e("router-link",{attrs:{to:"/admin/categories"}},[t._v("Categories")]),t._v(" | "),e("router-link",{attrs:{to:"/admin/users"}},[t._v("Users")])],1)},n=[],i=a(1001),s={},o=(0,i.Z)(s,r,n,!1,null,null,null),c=o.exports},7449:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container py-5"},[e("AdminNav"),e("form",{staticClass:"my-4"},[e("div",{staticClass:"form-row"},[e("div",{staticClass:"col-auto"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newCategory,expression:"newCategory"}],staticClass:"form-control",attrs:{type:"text",placeholder:"新增餐廳類別..."},domProps:{value:t.newCategory},on:{input:function(e){e.target.composing||(t.newCategory=e.target.value)}}})]),e("div",{staticClass:"col-auto"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addCategory.apply(null,arguments)}}},[t._v(" 新增 ")])])])]),e("table",{staticClass:"table"},[t._m(0),e("tbody",t._l(t.categories,(function(a){return e("tr",{key:a.id},[e("th",{attrs:{scope:"row"}},[t._v(" "+t._s(a.id)+" ")]),e("td",{staticClass:"position-relative"},[a.isEditing?e("input",{directives:[{name:"model",rawName:"v-model",value:a.name,expression:"category.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.name},on:{input:function(e){e.target.composing||t.$set(a,"name",e.target.value)}}}):e("div",{staticClass:"category-name"},[t._v(" "+t._s(a.name)+" ")]),e("span",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"}],staticClass:"cancel",on:{click:function(e){return t.cancelEdit(a.id)}}},[t._v(" ✕ ")])]),e("td",{staticClass:"d-flex justify-content-between"},[a.isEditing?e("button",{staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(e){return t.editCategory({category:a,CategoryId:a.id,name:a.name})}}},[t._v(" Save ")]):e("button",{staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(e){return t.edit(a.id)}}},[t._v(" Edit ")]),e("button",{staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(e){return t.deleteCategory(a.id)}}},[t._v(" Delete ")])])])})),0)])],1)},n=[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col",width:"60"}},[t._v(" # ")]),e("th",{attrs:{scope:"col"}},[t._v(" Category Name ")]),e("th",{attrs:{scope:"col",width:"210"}},[t._v(" Action ")])])])}],i=a(9669),s=a(4711),o=a(6163),c={components:{AdminNav:i.Z},data(){return{categories:[],newCategory:"",tempName:""}},created(){this.fetchCategories()},methods:{async fetchCategories(){try{const t=await(0,s.Kf)();if("error"===t.status)throw new Error(t.statusText);this.categories=t.data.categories.map((t=>({...t,isEditing:!1,tempName:""})))}catch(t){o.F.fire({icon:"error",title:"無法取得餐廳類別資訊，請稍後再試"})}},async addCategory(){try{const{data:t}=await(0,s.ER)({name:this.newCategory});if(this.newCategory="","error"===t.status)throw new Error(t.message);this.fetchCategories()}catch(t){o.F.fire({icon:"error",title:"無法新增餐廳類別，請稍後再試"})}},async deleteCategory(t){try{const{data:e}=await(0,s._9)(t);if("error"===e.status)throw new Error(e.message);this.fetchCategories()}catch(e){o.F.fire({icon:"error",title:"無法刪除餐廳類別，請稍後再試"})}},edit(t){this.categories=this.categories.map((e=>e.id===t?{...e,isEditing:!e.isEditing,tempName:e.name}:e))},async editCategory({category:t,CategoryId:e,name:a}){try{const{data:r}=await(0,s.aW)({CategoryId:e,name:a});if("error"===r.status)throw new Error(r.message);t.isEditing=!1}catch(r){o.F.fire({icon:"error",title:"無法修改餐廳類別名稱，請稍後再試"})}},cancelEdit(t){this.categories=this.categories.map((e=>(e.id===t&&(e.isEditing=!e.isEditing,e.name=e.tempName),e)))}}},u=c,l=a(1001),d=(0,l.Z)(u,r,n,!1,null,"311bf782",null),m=d.exports},4711:function(t,e,a){a.d(e,{ER:function(){return i},Kf:function(){return n},Pt:function(){return d},W6:function(){return m},Xx:function(){return u},Z$:function(){return l},_9:function(){return s},aW:function(){return o},yd:function(){return c}});var r=a(6163);const n=()=>r.l.get("/admin/categories"),i=({name:t})=>r.l.post("/admin/categories",{name:t}),s=t=>r.l["delete"](`/admin/categories/${t}`),o=({CategoryId:t,name:e})=>r.l.put(`/admin/categories/${t}`,{name:e}),c=t=>r.l.post("/admin/restaurants",t),u=()=>r.l.get("/admin/restaurants"),l=t=>r.l["delete"](`/admin/restaurants/${t}`),d=({restaurantId:t})=>r.l.get(`/admin/restaurants/${t}`),m=({restaurantId:t,formData:e})=>r.l.put(`/admin/restaurants/${t}`,e)}}]);
//# sourceMappingURL=449.b92bae6a.js.map